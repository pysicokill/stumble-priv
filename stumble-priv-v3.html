<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stumble Priv ‚Äî Top 30 Players</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --gold: #FFD700;
    --silver: #C0C0C0;
    --bronze: #CD7F32;
    --neon-cyan: #00FFFF;
    --neon-pink: #FF00FF;
    --neon-green: #00FF88;
    --bg-dark: #05050F;
    --glow-cyan: 0 0 10px #00FFFF, 0 0 30px #00FFFF55;
    --glow-gold: 0 0 15px #FFD700, 0 0 40px #FFD70077;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    background: var(--bg-dark);
    font-family: 'Rajdhani', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
    color: white;
  }

  /* BG */
  .grid-lines {
    position: fixed; top:0; left:0; width:100%; height:100%;
    background-image:
      linear-gradient(rgba(0,255,255,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,255,255,0.03) 1px, transparent 1px);
    background-size: 60px 60px; z-index: 0;
    animation: gridMove 25s linear infinite;
  }
  @keyframes gridMove { from{background-position:0 0} to{background-position:60px 60px} }

  .particles { position:fixed; top:0; left:0; width:100%; height:100%; z-index:0; pointer-events:none; }
  .particle { position:absolute; border-radius:50%; animation: floatUp linear infinite; opacity:0; }
  @keyframes floatUp {
    0%{transform:translateY(100vh) scale(0);opacity:0}
    10%{opacity:0.7} 90%{opacity:0.4}
    100%{transform:translateY(-10vh) scale(1.2);opacity:0}
  }

  /* MUSIC BTN */
  .music-btn {
    position:fixed; top:14px; left:14px; z-index:999;
    background:rgba(0,255,255,0.1); border:1px solid rgba(0,255,255,0.3);
    border-radius:50%; width:44px; height:44px;
    display:flex; align-items:center; justify-content:center;
    font-size:1.2rem; cursor:pointer; transition:all 0.3s;
    backdrop-filter:blur(10px);
  }
  .music-btn:hover { box-shadow:var(--glow-cyan); border-color:#00FFFF; }
  .music-btn.playing { animation:musicPulse 1s ease-in-out infinite; }
  @keyframes musicPulse { 0%,100%{box-shadow:0 0 5px #00FFFF} 50%{box-shadow:0 0 25px #00FFFF,0 0 50px #00FFFF55} }

  /* HEADER */
  header { position:relative; z-index:10; text-align:center; padding:52px 20px 20px; }
  .logo-wrapper { display:inline-block; position:relative; }
  .logo-glow {
    position:absolute; inset:-20px;
    background:radial-gradient(ellipse, rgba(0,255,255,0.15) 0%, transparent 70%);
    animation:pulse 3s ease-in-out infinite;
  }
  @keyframes pulse { 0%,100%{transform:scale(1);opacity:0.7} 50%{transform:scale(1.1);opacity:1} }
  .site-title {
    font-family:'Orbitron',monospace; font-size:clamp(1.8rem,6vw,5rem);
    font-weight:900; letter-spacing:6px; text-transform:uppercase;
    background:linear-gradient(135deg,#00FFFF,#FF00FF,#FFD700,#00FF88);
    background-size:300% 300%;
    -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
    animation:gradShift 4s ease infinite; position:relative; z-index:1;
    filter:drop-shadow(0 0 20px rgba(0,255,255,0.5));
  }
  @keyframes gradShift { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
  .site-subtitle {
    font-family:'Orbitron',monospace; font-size:clamp(0.55rem,2vw,1rem);
    letter-spacing:6px; color:rgba(0,255,255,0.7); text-transform:uppercase;
    margin-top:8px; animation:blink 2s ease-in-out infinite;
  }
  @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.5} }
  .divider {
    width:80%; max-width:600px; height:2px;
    background:linear-gradient(90deg,transparent,#00FFFF,#FF00FF,transparent);
    margin:16px auto; position:relative;
  }
  .divider::after {
    content:'‚óÜ'; position:absolute; top:50%; left:50%;
    transform:translate(-50%,-50%); color:#FFD700; font-size:1rem;
    text-shadow:var(--glow-gold); animation:rotateDiamond 4s linear infinite;
  }
  @keyframes rotateDiamond { from{transform:translate(-50%,-50%) rotate(0)} to{transform:translate(-50%,-50%) rotate(360deg)} }

  /* STATS BAR */
  .stats-bar {
    display:flex; justify-content:center; gap:10px; flex-wrap:wrap;
    padding:0 14px 16px; position:relative; z-index:10;
  }
  .stat-item {
    background:rgba(0,255,255,0.05); border:1px solid rgba(0,255,255,0.2);
    border-radius:12px; padding:10px 16px; text-align:center;
    backdrop-filter:blur(10px); transition:all 0.3s;
    flex:1; min-width:90px; max-width:180px;
  }
  .stat-item:hover { border-color:#00FFFF; box-shadow:var(--glow-cyan); transform:translateY(-3px); }
  .stat-label { font-size:0.6rem; letter-spacing:2px; color:rgba(0,255,255,0.6); text-transform:uppercase; }
  .stat-value { font-family:'Orbitron',monospace; font-size:1.2rem; font-weight:900; color:#00FFFF; text-shadow:var(--glow-cyan); }
  .stat-value.small { font-size:0.8rem; }

  /* VISIT COUNTER */
  .visit-bar {
    text-align:center; position:relative; z-index:10;
    margin-bottom:6px; padding:0 14px;
  }
  .visit-badge {
    display:inline-flex; align-items:center; gap:8px;
    background:rgba(255,0,255,0.06); border:1px solid rgba(255,0,255,0.2);
    border-radius:30px; padding:6px 18px;
    font-size:0.7rem; letter-spacing:2px; color:rgba(255,255,255,0.5);
    text-transform:uppercase;
  }
  .visit-count { font-family:'Orbitron',monospace; color:#FF00FF; font-size:0.85rem; font-weight:700; text-shadow:0 0 10px #FF00FF; }
  .visit-dot { width:6px; height:6px; border-radius:50%; background:#00FF88; box-shadow:0 0 8px #00FF88; animation:dotPulse 1.5s ease-in-out infinite; }
  @keyframes dotPulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:0.5;transform:scale(0.7)} }

  /* LAST UPDATED */
  .last-updated-bar {
    text-align:center; position:relative; z-index:10;
    margin-bottom:20px; font-size:0.65rem; letter-spacing:2px;
    color:rgba(255,255,255,0.25);
  }
  .last-updated-bar span { color:#00FF88; }

  /* LEADERBOARD */
  .leaderboard-container {
    position:relative; z-index:10;
    max-width:920px; margin:0 auto;
    padding:0 12px 100px;
  }
  .section-title {
    font-family:'Orbitron',monospace; font-size:0.9rem; letter-spacing:5px;
    color:rgba(255,255,255,0.35); text-transform:uppercase;
    text-align:center; margin-bottom:18px;
  }

  /* PODIUM */
  .podium {
    display:flex; justify-content:center; align-items:flex-end;
    gap:8px; margin-bottom:30px; flex-wrap:wrap;
  }
  .podium-card {
    background:rgba(10,10,40,0.9); border-radius:16px;
    padding:18px 12px; text-align:center; position:relative;
    overflow:hidden; transition:transform 0.3s;
    backdrop-filter:blur(20px);
    flex:1; min-width:120px; max-width:260px;
  }
  .podium-card:hover { transform:translateY(-6px) scale(1.02); }
  .podium-card::before { content:''; position:absolute; top:0; left:0; right:0; height:3px; }
  .podium-1 { order:2; border:2px solid var(--gold); box-shadow:0 0 30px rgba(255,215,0,0.3); }
  .podium-1::before { background:linear-gradient(90deg,transparent,var(--gold),transparent); }
  .podium-2 { order:1; border:2px solid var(--silver); box-shadow:0 0 20px rgba(192,192,192,0.2); }
  .podium-2::before { background:linear-gradient(90deg,transparent,var(--silver),transparent); }
  .podium-3 { order:3; border:2px solid var(--bronze); box-shadow:0 0 20px rgba(205,127,50,0.2); }
  .podium-3::before { background:linear-gradient(90deg,transparent,var(--bronze),transparent); }

  .podium-rank { font-family:'Orbitron',monospace; font-size:2rem; font-weight:900; margin-bottom:4px; }
  .podium-1 .podium-rank { color:var(--gold); text-shadow:var(--glow-gold); }
  .podium-2 .podium-rank { color:var(--silver); }
  .podium-3 .podium-rank { color:var(--bronze); }
  .podium-crown { font-size:1.7rem; margin-bottom:4px; animation:bounce 2s ease-in-out infinite; }
  @keyframes bounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-5px)} }
  .podium-nick {
    font-family:'Orbitron',monospace; font-size:clamp(0.6rem,2vw,0.9rem);
    font-weight:700; letter-spacing:1px; color:white;
    margin-bottom:8px; word-break:break-all;
  }

  /* BADGE */
  .badge {
    display:inline-block; font-size:0.58rem; letter-spacing:1px;
    padding:3px 8px; border-radius:20px; font-weight:700;
    text-transform:uppercase; margin-bottom:10px;
    font-family:'Rajdhani',sans-serif;
  }
  .badge-legend  { background:linear-gradient(135deg,#FFD700,#FF8800); color:#000; box-shadow:0 0 10px rgba(255,215,0,0.5); }
  .badge-elite   { background:linear-gradient(135deg,#00FFFF,#0088FF); color:#000; box-shadow:0 0 10px rgba(0,255,255,0.4); }
  .badge-pro     { background:linear-gradient(135deg,#FF00FF,#8800FF); color:#fff; box-shadow:0 0 10px rgba(255,0,255,0.4); }
  .badge-veteran { background:linear-gradient(135deg,#00FF88,#00AA55); color:#000; }
  .badge-rising  { background:linear-gradient(135deg,#FF4488,#FF0044); color:#fff; }
  .badge-hunter  { background:linear-gradient(135deg,#888,#444); color:#fff; }
  .badge-newcomer{ background:rgba(255,255,255,0.08); color:rgba(255,255,255,0.5); border:1px solid rgba(255,255,255,0.15); }

  .podium-stats { display:flex; justify-content:center; gap:6px; flex-wrap:wrap; }
  .pstat {
    display:flex; align-items:center; gap:3px;
    background:rgba(255,255,255,0.07); border-radius:8px;
    padding:4px 7px; font-size:0.8rem; font-weight:700;
  }
  .pstat .val { font-family:'Orbitron',monospace; font-size:0.75rem; }
  .podium-1::after {
    content:''; position:absolute; top:-50%; left:-60%;
    width:40%; height:200%; background:linear-gradient(90deg,transparent,rgba(255,215,0,0.1),transparent);
    transform:skewX(-15deg); animation:shimmer 3s ease-in-out infinite;
  }
  @keyframes shimmer { 0%{left:-60%} 100%{left:120%} }

  /* LIST */
  .player-row {
    display:grid;
    /* rank | nick+badge | trophy | medals */
    grid-template-columns: 44px 1fr auto auto;
    align-items:center; padding:11px 14px; margin-bottom:5px;
    background:rgba(10,10,40,0.75);
    border:1px solid rgba(255,255,255,0.06);
    border-radius:12px; transition:all 0.25s;
    backdrop-filter:blur(10px);
    animation:rowIn 0.4s ease both; position:relative; overflow:hidden;
    gap:8px;
  }
  .player-row::before {
    content:''; position:absolute; left:0; top:0; bottom:0; width:3px;
    background:linear-gradient(180deg,#00FFFF,#FF00FF);
    opacity:0; transition:opacity 0.3s;
  }
  .player-row:hover {
    border-color:rgba(0,255,255,0.3);
    background:rgba(0,255,255,0.06);
    box-shadow:0 4px 20px rgba(0,255,255,0.1);
    transform:translateX(4px);
  }
  .player-row:hover::before { opacity:1; }
  @keyframes rowIn { from{opacity:0;transform:translateX(-20px)} to{opacity:1;transform:translateX(0)} }

  .rank-num {
    font-family:'Orbitron',monospace; font-size:0.85rem; font-weight:700;
    color:rgba(255,255,255,0.3); text-align:center; flex-shrink:0;
  }
  .rank-num.top5  { color:#00FFFF; text-shadow:var(--glow-cyan); }
  .rank-num.top10 { color:#AA88FF; }

  .player-info { display:flex; flex-direction:column; gap:2px; min-width:0; }
  .player-nick {
    font-family:'Orbitron',monospace; font-size:clamp(0.6rem,1.8vw,0.85rem);
    font-weight:700; letter-spacing:1px; color:white; word-break:break-all;
  }
  .badge-inline {
    font-size:0.5rem; letter-spacing:1px;
    padding:2px 6px; border-radius:10px; font-weight:700;
    text-transform:uppercase; display:inline-block;
    font-family:'Rajdhani',sans-serif; width:fit-content;
  }

  /* TROPHIES */
  .trophies-col {
    display:flex; align-items:center; gap:4px;
    font-family:'Orbitron',monospace; font-size:0.8rem; font-weight:700;
    color:var(--gold); text-shadow:var(--glow-gold);
    flex-shrink:0; white-space:nowrap;
  }
  .trophy-icon { font-size:1rem; }

  /* MEDALS ‚Äî now always visible, stacked on mobile */
  .medals-col {
    display:flex; flex-direction:column; gap:3px; align-items:flex-end; flex-shrink:0;
  }
  .medal {
    display:flex; align-items:center; gap:2px;
    font-size:0.68rem; font-weight:700;
    font-family:'Orbitron',monospace; padding:2px 6px;
    border-radius:5px; background:rgba(255,255,255,0.05);
    white-space:nowrap;
  }
  .medal-icon { font-size:0.85rem; }
  .medal.gold-m   { color:var(--gold);   border:1px solid rgba(255,215,0,0.3); }
  .medal.silver-m { color:var(--silver); border:1px solid rgba(192,192,192,0.3); }
  .medal.bronze-m { color:var(--bronze); border:1px solid rgba(205,127,50,0.3); }

  /* EDIT BTN */
  .edit-btn {
    position:fixed; bottom:20px; right:20px; z-index:999;
    background:linear-gradient(135deg,#00FFFF,#FF00FF);
    color:#000; font-family:'Orbitron',monospace;
    font-weight:900; font-size:0.68rem; letter-spacing:2px;
    padding:11px 18px; border:none; border-radius:50px;
    cursor:pointer; text-transform:uppercase;
    box-shadow:0 0 20px rgba(0,255,255,0.5); transition:all 0.3s;
  }
  .edit-btn:hover { transform:scale(1.05); box-shadow:0 0 40px rgba(0,255,255,0.8); }

  /* MODAL */
  .modal-overlay {
    display:none; position:fixed; inset:0; z-index:9999;
    background:rgba(0,0,0,0.88); backdrop-filter:blur(10px);
    justify-content:center; align-items:center; padding:14px;
  }
  .modal-overlay.open { display:flex; }
  .modal {
    background:#0a0a2a; border:1px solid rgba(0,255,255,0.3);
    border-radius:20px; padding:22px;
    width:100%; max-width:720px; max-height:92vh; overflow-y:auto;
    box-shadow:0 0 60px rgba(0,255,255,0.2);
  }
  .modal h2 {
    font-family:'Orbitron',monospace; font-size:0.95rem; letter-spacing:3px;
    color:#00FFFF; margin-bottom:16px; text-align:center; text-transform:uppercase;
  }
  .password-screen { text-align:center; }
  .password-screen input {
    background:rgba(0,255,255,0.05); border:1px solid rgba(0,255,255,0.3);
    border-radius:10px; padding:12px 20px; color:white;
    font-family:'Orbitron',monospace; font-size:1rem;
    width:100%; max-width:300px; text-align:center; letter-spacing:4px; outline:none; margin:10px 0;
  }
  .password-screen input:focus { border-color:#00FFFF; box-shadow:var(--glow-cyan); }
  .modal-btn {
    background:linear-gradient(135deg,#00FFFF22,#FF00FF22);
    border:1px solid rgba(0,255,255,0.4); color:white;
    font-family:'Orbitron',monospace; font-size:0.68rem; letter-spacing:2px;
    padding:9px 18px; border-radius:8px; cursor:pointer;
    text-transform:uppercase; transition:all 0.3s; margin:4px;
  }
  .modal-btn:hover { background:rgba(0,255,255,0.15); box-shadow:var(--glow-cyan); }
  .modal-btn.danger { border-color:rgba(255,0,100,0.4); color:#FF4488; }
  .modal-btn.danger:hover { background:rgba(255,0,100,0.1); }
  .edit-table { width:100%; border-collapse:collapse; }
  .edit-table th {
    font-family:'Orbitron',monospace; font-size:0.58rem; letter-spacing:2px;
    color:rgba(0,255,255,0.7); padding:6px 5px; text-align:left;
    border-bottom:1px solid rgba(0,255,255,0.1);
  }
  .edit-table td { padding:4px 3px; }
  .edit-table input {
    width:100%; background:rgba(255,255,255,0.05);
    border:1px solid rgba(255,255,255,0.1); border-radius:6px;
    padding:5px 6px; color:white; font-family:'Rajdhani',sans-serif;
    font-size:0.85rem; outline:none; transition:border-color 0.2s;
  }
  .edit-table input:focus { border-color:#00FFFF; }
  .row-del {
    background:none; border:none; color:#FF4488;
    font-size:1.1rem; cursor:pointer; padding:3px 6px;
    border-radius:4px; transition:background 0.2s;
  }
  .row-del:hover { background:rgba(255,0,100,0.1); }
  .err-msg { color:#FF4488; font-size:0.8rem; margin-top:8px; }
  .success-msg { color:#00FF88; font-size:0.8rem; margin-top:8px; }

  /* MOBILE TWEAKS */
  @media(max-width:480px) {
    .stats-bar { gap:6px; }
    .stat-item { padding:8px 10px; min-width:80px; }
    .stat-value { font-size:1rem; }
    .podium { gap:6px; }
    .podium-card { min-width:100px; padding:14px 8px; }
    .podium-rank { font-size:1.5rem; }
    .podium-crown { font-size:1.3rem; }
    .player-row { grid-template-columns:38px 1fr auto auto; gap:6px; padding:9px 10px; }
    .player-nick { font-size:0.65rem; }
    .trophies-col { font-size:0.72rem; }
    .medal { font-size:0.6rem; padding:1px 4px; }
    .edit-btn { bottom:14px; right:14px; }
    header { padding:52px 12px 14px; }
  }

  ::-webkit-scrollbar { width:5px; }
  ::-webkit-scrollbar-track { background:#050510; }
  ::-webkit-scrollbar-thumb { background:linear-gradient(#00FFFF,#FF00FF); border-radius:3px; }
</style>
</head>
<body>

<div class="grid-lines"></div>
<div class="particles" id="particles"></div>

<button class="music-btn" id="music-btn" onclick="toggleMusic()" title="M√∫sica">üéµ</button>

<header>
  <div class="logo-wrapper">
    <div class="logo-glow"></div>
    <div class="site-title">STUMBLE PRIV</div>
  </div>
  <div class="site-subtitle">‚ö° Hall of Fame ¬∑ Top 30 Players ‚ö°</div>
  <div class="divider"></div>
</header>

<div class="stats-bar">
  <div class="stat-item">
    <div class="stat-label">Ranked</div>
    <div class="stat-value" id="total-players">30</div>
  </div>
  <div class="stat-item">
    <div class="stat-label">Total Trophies</div>
    <div class="stat-value" id="total-trophies">0</div>
  </div>
  <div class="stat-item">
    <div class="stat-label">üèÜ Leader</div>
    <div class="stat-value small" id="leader-name">‚Äî</div>
  </div>
  <div class="stat-item">
    <div class="stat-label">üëÅ Visitas</div>
    <div class="stat-value" id="visit-count-stat">‚Äî</div>
  </div>
</div>

<div class="visit-bar">
  <div class="visit-badge">
    <div class="visit-dot"></div>
    <span>Visitas totais:</span>
    <span class="visit-count" id="visit-display">carregando...</span>
  </div>
</div>

<div class="last-updated-bar">Atualizado em: <span id="last-updated-val">‚Äî</span></div>

<div class="leaderboard-container">
  <div class="section-title">‚ú¶ Podium ‚ú¶</div>
  <div class="podium" id="podium"></div>

  <div class="section-title" style="margin-top:28px;">‚ú¶ Rankings ‚ú¶</div>
  <div id="player-list"></div>
</div>

<button class="edit-btn" onclick="openModal()">‚öô EDIT</button>

<div class="modal-overlay" id="modal-overlay">
  <div class="modal">
    <div id="password-screen" class="password-screen">
      <h2>üîê Admin Access</h2>
      <input type="password" id="pwd-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="30"
        onkeydown="if(event.key==='Enter')checkPwd()">
      <br>
      <button class="modal-btn" onclick="checkPwd()">ENTER</button>
      <button class="modal-btn danger" onclick="closeModal()">CANCEL</button>
      <div id="pwd-error" class="err-msg"></div>
    </div>
    <div id="edit-screen" style="display:none">
      <h2>‚ö° Edit Rankings</h2>
      <div style="overflow-x:auto">
        <table class="edit-table">
          <thead>
            <tr><th>#</th><th>Nick</th><th>üèÜ Trof√©us</th><th>ü•á Top1</th><th>ü•à Top2</th><th>ü•â Top3</th><th></th></tr>
          </thead>
          <tbody id="edit-tbody"></tbody>
        </table>
      </div>
      <div style="margin-top:12px;display:flex;gap:6px;flex-wrap:wrap">
        <button class="modal-btn" onclick="addRow()">+ ADD</button>
        <button class="modal-btn" onclick="saveData()" style="border-color:rgba(0,255,136,0.4);color:#00FF88">üíæ SAVE</button>
        <button class="modal-btn danger" onclick="closeModal()">‚úï FECHAR</button>
      </div>
      <div id="save-msg"></div>
    </div>
  </div>
</div>

<script>
// ============================================================
// CONFIG ‚Äî troque a senha aqui
// ============================================================
const ADMIN_PASSWORD = "stumble2024";

let players = [
  { nick:"ShadowStrike",  trophies:1310, gold:28, silver:14, bronze:9  },
  { nick:"VortexKing",    trophies:1180, gold:22, silver:18, bronze:11 },
  { nick:"NovaBlast",     trophies:1050, gold:19, silver:12, bronze:7  },
  { nick:"ZeroGravity",   trophies: 980, gold:16, silver:10, bronze:8  },
  { nick:"IronPhoenix",   trophies: 890, gold:14, silver:9,  bronze:5  },
  { nick:"ThunderX",      trophies: 820, gold:12, silver:11, bronze:6  },
  { nick:"CryptoWolf",    trophies: 760, gold:11, silver:8,  bronze:4  },
  { nick:"NeonFury",      trophies: 710, gold:10, silver:7,  bronze:5  },
  { nick:"GhostReaper",   trophies: 670, gold: 9, silver:6,  bronze:3  },
  { nick:"StormBlade",    trophies: 630, gold: 8, silver:5,  bronze:4  },
  { nick:"PyroStorm",     trophies: 590, gold: 7, silver:6,  bronze:2  },
  { nick:"DarkMatter",    trophies: 550, gold: 6, silver:4,  bronze:5  },
  { nick:"PixelPunch",    trophies: 510, gold: 5, silver:7,  bronze:3  },
  { nick:"Razorback",     trophies: 480, gold: 5, silver:3,  bronze:4  },
  { nick:"VoidWalker",    trophies: 450, gold: 4, silver:5,  bronze:2  },
  { nick:"BlazeRunner",   trophies: 420, gold: 4, silver:4,  bronze:3  },
  { nick:"QuantumLeap",   trophies: 390, gold: 3, silver:5,  bronze:4  },
  { nick:"SteelNova",     trophies: 360, gold: 3, silver:3,  bronze:3  },
  { nick:"ArcaneKnight",  trophies: 330, gold: 3, silver:2,  bronze:5  },
  { nick:"FrostBite",     trophies: 300, gold: 2, silver:4,  bronze:3  },
  { nick:"TitanFall",     trophies: 270, gold: 2, silver:3,  bronze:4  },
  { nick:"OmegaForce",    trophies: 245, gold: 2, silver:2,  bronze:2  },
  { nick:"NightCrawler",  trophies: 220, gold: 2, silver:2,  bronze:1  },
  { nick:"WarpZone",      trophies: 195, gold: 1, silver:3,  bronze:2  },
  { nick:"EchoStrike",    trophies: 175, gold: 1, silver:2,  bronze:3  },
  { nick:"HexHunter",     trophies: 155, gold: 1, silver:2,  bronze:2  },
  { nick:"PlasmaBolt",    trophies: 135, gold: 1, silver:1,  bronze:3  },
  { nick:"ChaosEngine",   trophies: 115, gold: 0, silver:2,  bronze:4  },
  { nick:"DigitalWraith", trophies:  95, gold: 0, silver:1,  bronze:3  },
  { nick:"StarKiller",    trophies:  75, gold: 0, silver:1,  bronze:2  },
];

// ============================================================
// VISIT COUNTER (localStorage ‚Äî conta por dispositivo)
// ============================================================
function initVisits() {
  try {
    // Conta visita √∫nica por sess√£o
    const sessionKey = 'stumble_visited_session';
    const totalKey   = 'stumble_visits_total';

    let total = parseInt(localStorage.getItem(totalKey) || '0');

    if (!sessionStorage.getItem(sessionKey)) {
      total++;
      localStorage.setItem(totalKey, total);
      sessionStorage.setItem(sessionKey, '1');
    }

    updateVisitDisplay(total);
  } catch(e) {
    updateVisitDisplay('‚Äî');
  }
}

function updateVisitDisplay(n) {
  const fmt = typeof n === 'number' ? n.toLocaleString('pt-BR') : n;
  const el1 = document.getElementById('visit-display');
  const el2 = document.getElementById('visit-count-stat');
  if (el1) el1.textContent = fmt;
  if (el2) el2.textContent = fmt;
}

// ============================================================
// BADGE
// ============================================================
function getBadge(p, rank) {
  if (rank === 1)         return { cls:'badge-legend',  label:'üëë Lenda'    };
  if (rank <= 3)          return { cls:'badge-elite',   label:'‚ö° Elite'    };
  if (rank <= 5)          return { cls:'badge-pro',     label:'üíé Pro'      };
  if (p.trophies >= 400)  return { cls:'badge-veteran', label:'üî• Veteran'  };
  if (p.gold >= 1)        return { cls:'badge-hunter',  label:'üéØ Hunter'   };
  if (p.trophies >= 100)  return { cls:'badge-rising',  label:'üìà Rising'   };
  return                         { cls:'badge-newcomer',label:'üå± Newcomer' };
}

// ============================================================
// STORAGE
// ============================================================
function loadData() {
  try {
    const s = localStorage.getItem('stumble_priv_v3');
    if (s) players = JSON.parse(s);
    const ts = localStorage.getItem('stumble_priv_ts');
    document.getElementById('last-updated-val').textContent = ts || '‚Äî';
  } catch(e) {}
}
function saveToStorage() {
  const now = new Date().toLocaleString('pt-BR');
  localStorage.setItem('stumble_priv_v3', JSON.stringify(players));
  localStorage.setItem('stumble_priv_ts', now);
  document.getElementById('last-updated-val').textContent = now;
}

// ============================================================
// RENDER
// ============================================================
function escHtml(s) {
  return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

function medalHtml(p) {
  const parts = [];
  if (p.gold   > 0) parts.push(`<div class="medal gold-m"><span class="medal-icon">ü•á</span>${p.gold}</div>`);
  if (p.silver > 0) parts.push(`<div class="medal silver-m"><span class="medal-icon">ü•à</span>${p.silver}</div>`);
  if (p.bronze > 0) parts.push(`<div class="medal bronze-m"><span class="medal-icon">ü•â</span>${p.bronze}</div>`);
  return parts.join('') || '<span style="opacity:0.25;font-size:0.7rem">‚Äî</span>';
}

function renderAll() {
  const sorted = [...players].sort((a,b) => b.trophies - a.trophies).slice(0,30);
  renderPodium(sorted);
  renderList(sorted);
  renderStats(sorted);
}

function renderPodium(sorted) {
  const el = document.getElementById('podium');
  el.innerHTML = '';
  sorted.slice(0,3).forEach((p, i) => {
    const badge = getBadge(p, i+1);
    const crowns = ['üëë','ü•à','ü•â'];
    const labels = ['#1','#2','#3'];
    const div = document.createElement('div');
    div.className = 'podium-card podium-' + (i+1);
    div.innerHTML = `
      <div class="podium-crown">${crowns[i]}</div>
      <div class="podium-rank">${labels[i]}</div>
      <div class="podium-nick">${escHtml(p.nick)}</div>
      <div><span class="badge ${badge.cls}">${badge.label}</span></div>
      <div class="podium-stats">
        <div class="pstat"><span>üèÜ</span><span class="val">${p.trophies}</span></div>
        ${p.gold>0   ? `<div class="pstat"><span>ü•á</span><span class="val">${p.gold}</span></div>` : ''}
        ${p.silver>0 ? `<div class="pstat"><span>ü•à</span><span class="val">${p.silver}</span></div>` : ''}
        ${p.bronze>0 ? `<div class="pstat"><span>ü•â</span><span class="val">${p.bronze}</span></div>` : ''}
      </div>`;
    el.appendChild(div);
  });
}

function renderList(sorted) {
  const el = document.getElementById('player-list');
  el.innerHTML = '';
  sorted.slice(3).forEach((p, idx) => {
    const rank = idx + 4;
    const badge = getBadge(p, rank);
    const row = document.createElement('div');
    row.className = 'player-row';
    row.style.animationDelay = (idx * 0.03) + 's';
    const rankClass = rank <= 5 ? 'top5' : rank <= 10 ? 'top10' : '';
    row.innerHTML = `
      <div class="rank-num ${rankClass}">${rank}</div>
      <div class="player-info">
        <div class="player-nick">${escHtml(p.nick)}</div>
        <span class="badge-inline ${badge.cls}">${badge.label}</span>
      </div>
      <div class="trophies-col"><span class="trophy-icon">üèÜ</span>${p.trophies}</div>
      <div class="medals-col">${medalHtml(p)}</div>`;
    el.appendChild(row);
  });
}

function renderStats(sorted) {
  document.getElementById('total-players').textContent = sorted.length;
  document.getElementById('total-trophies').textContent = sorted.reduce((s,p)=>s+p.trophies,0).toLocaleString();
  document.getElementById('leader-name').textContent = sorted[0]?.nick || '‚Äî';
}

// ============================================================
// MUSIC
// ============================================================
let audioCtx = null, musicPlaying = false, musicNodes = [], scheduleTimer = null;

function toggleMusic() {
  musicPlaying ? stopMusic() : startMusic();
}

function startMusic() {
  if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  if (audioCtx.state === 'suspended') audioCtx.resume();
  musicPlaying = true;
  document.getElementById('music-btn').textContent = 'üîä';
  document.getElementById('music-btn').classList.add('playing');

  const chords = [
    [130.81,164.81,196.00],
    [116.54,146.83,174.61],
    [103.83,130.81,155.56],
    [123.47,155.56,185.00],
  ];
  let step = 0, t = audioCtx.currentTime;

  function playNote(freq, time, dur, vol, type='sawtooth') {
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    const filt = audioCtx.createBiquadFilter();
    filt.type = 'lowpass'; filt.frequency.value = 900;
    osc.type = type; osc.frequency.value = freq;
    gain.gain.setValueAtTime(0, time);
    gain.gain.linearRampToValueAtTime(vol, time + 0.25);
    gain.gain.linearRampToValueAtTime(vol * 0.7, time + dur - 0.4);
    gain.gain.linearRampToValueAtTime(0, time + dur);
    osc.connect(filt); filt.connect(gain); gain.connect(audioCtx.destination);
    osc.start(time); osc.stop(time + dur);
    musicNodes.push(osc);
  }

  function loop() {
    if (!musicPlaying) return;
    const chord = chords[step % chords.length];
    chord.forEach(f => playNote(f, t, 2.2, 0.035));
    playNote(chord[0] / 2, t, 0.7, 0.07, 'sine');
    playNote(chord[0] / 2, t + 1.5, 0.5, 0.06, 'sine');
    step++; t += 2.5;
    scheduleTimer = setTimeout(loop, Math.max(0, (t - audioCtx.currentTime - 0.3) * 1000));
  }
  loop();
}

function stopMusic() {
  musicPlaying = false;
  clearTimeout(scheduleTimer);
  document.getElementById('music-btn').textContent = 'üéµ';
  document.getElementById('music-btn').classList.remove('playing');
  musicNodes.forEach(n => { try { n.stop(); } catch(e){} });
  musicNodes = [];
}

// ============================================================
// PARTICLES
// ============================================================
function spawnParticles() {
  const c = document.getElementById('particles');
  const colors = ['#00FFFF','#FF00FF','#FFD700','#00FF88','#AA88FF'];
  for (let i = 0; i < 35; i++) {
    const p = document.createElement('div');
    p.className = 'particle';
    const sz = Math.random() * 4 + 2;
    const col = colors[Math.floor(Math.random() * colors.length)];
    p.style.cssText = `width:${sz}px;height:${sz}px;left:${Math.random()*100}%;background:${col};box-shadow:0 0 ${sz*2}px ${col};animation-duration:${6+Math.random()*10}s;animation-delay:${Math.random()*8}s;`;
    c.appendChild(p);
  }
}

// ============================================================
// ADMIN
// ============================================================
function openModal() {
  document.getElementById('modal-overlay').classList.add('open');
  document.getElementById('password-screen').style.display='block';
  document.getElementById('edit-screen').style.display='none';
  document.getElementById('pwd-input').value='';
  document.getElementById('pwd-error').textContent='';
  setTimeout(()=>document.getElementById('pwd-input').focus(),100);
}
function closeModal() { document.getElementById('modal-overlay').classList.remove('open'); }

function checkPwd() {
  if (document.getElementById('pwd-input').value === ADMIN_PASSWORD) {
    document.getElementById('password-screen').style.display='none';
    document.getElementById('edit-screen').style.display='block';
    buildEditTable();
  } else {
    document.getElementById('pwd-error').textContent='‚ùå Senha incorreta!';
    document.getElementById('pwd-input').value='';
    document.getElementById('pwd-input').focus();
  }
}

function buildEditTable() {
  const sorted = [...players].sort((a,b)=>b.trophies-a.trophies).slice(0,30);
  window._editSorted = sorted;
  const tbody = document.getElementById('edit-tbody');
  tbody.innerHTML = '';
  sorted.forEach((p,i) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td style="color:rgba(0,255,255,0.6);font-family:'Orbitron',monospace;text-align:center;padding:4px 5px">${i+1}</td>
      <td><input type="text" value="${escHtml(p.nick)}" data-field="nick" data-idx="${i}"></td>
      <td><input type="number" value="${p.trophies}" min="0" data-field="trophies" data-idx="${i}"></td>
      <td><input type="number" value="${p.gold}" min="0" data-field="gold" data-idx="${i}"></td>
      <td><input type="number" value="${p.silver}" min="0" data-field="silver" data-idx="${i}"></td>
      <td><input type="number" value="${p.bronze}" min="0" data-field="bronze" data-idx="${i}"></td>
      <td><button class="row-del" onclick="deleteRow(${i})">‚úï</button></td>`;
    tbody.appendChild(tr);
  });
}

function deleteRow(idx) {
  if (!confirm('Remover jogador?')) return;
  const nick = window._editSorted[idx].nick;
  players = players.filter(p => p.nick !== nick);
  buildEditTable();
}

function addRow() {
  players.push({nick:'NewPlayer',trophies:0,gold:0,silver:0,bronze:0});
  buildEditTable();
  document.getElementById('edit-tbody').lastElementChild?.scrollIntoView({behavior:'smooth'});
}

function saveData() {
  const sorted = window._editSorted;
  document.querySelectorAll('#edit-tbody input').forEach(input => {
    const idx = parseInt(input.dataset.idx);
    const field = input.dataset.field;
    if (field === 'nick') sorted[idx].nick = input.value.trim() || 'Unknown';
    else sorted[idx][field] = Math.max(0, parseInt(input.value)||0);
  });
  players = sorted;
  saveToStorage();
  renderAll();
  const msg = document.getElementById('save-msg');
  msg.className = 'success-msg';
  msg.textContent = '‚úÖ Salvo com sucesso!';
  setTimeout(()=>msg.textContent='', 3000);
  buildEditTable();
}

document.getElementById('modal-overlay').addEventListener('click', function(e){
  if(e.target===this) closeModal();
});

// ============================================================
// INIT
// ============================================================
loadData();
renderAll();
spawnParticles();
initVisits();
</script>
</body>
</html>
