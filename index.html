<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stumble Priv ‚Äî Top 30 Players</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --gold: #FFD700;
    --silver: #C0C0C0;
    --bronze: #CD7F32;
    --neon-cyan: #00FFFF;
    --neon-pink: #FF00FF;
    --neon-green: #00FF88;
    --bg-dark: #05050F;
    --glow-cyan: 0 0 10px #00FFFF, 0 0 30px #00FFFF55;
    --glow-pink: 0 0 10px #FF00FF, 0 0 30px #FF00FF55;
    --glow-gold: 0 0 15px #FFD700, 0 0 40px #FFD70077;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    background: var(--bg-dark);
    font-family: 'Rajdhani', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
    color: white;
  }

  /* ===== BG ===== */
  .grid-lines {
    position: fixed; top:0; left:0; width:100%; height:100%;
    background-image:
      linear-gradient(rgba(0,255,255,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,255,255,0.03) 1px, transparent 1px);
    background-size: 60px 60px;
    z-index: 0;
    animation: gridMove 25s linear infinite;
  }
  @keyframes gridMove { from{background-position:0 0} to{background-position:60px 60px} }

  .particles { position:fixed; top:0; left:0; width:100%; height:100%; z-index:0; pointer-events:none; }
  .particle {
    position:absolute;
    border-radius:50%;
    animation: floatUp linear infinite;
    opacity: 0;
  }
  @keyframes floatUp {
    0%   { transform: translateY(100vh) scale(0); opacity:0; }
    10%  { opacity: 0.7; }
    90%  { opacity: 0.4; }
    100% { transform: translateY(-10vh) scale(1.2); opacity:0; }
  }

  /* ===== HEADER ===== */
  header {
    position: relative; z-index: 10;
    text-align: center;
    padding: 60px 20px 30px;
  }
  .logo-wrapper {
    display: inline-block;
    position: relative;
  }
  .logo-glow {
    position: absolute; inset: -20px;
    background: radial-gradient(ellipse, rgba(0,255,255,0.15) 0%, transparent 70%);
    animation: pulse 3s ease-in-out infinite;
  }
  @keyframes pulse { 0%,100%{transform:scale(1);opacity:0.7} 50%{transform:scale(1.1);opacity:1} }

  .site-title {
    font-family: 'Orbitron', monospace;
    font-size: clamp(2rem, 6vw, 5rem);
    font-weight: 900;
    letter-spacing: 6px;
    text-transform: uppercase;
    background: linear-gradient(135deg, #00FFFF, #FF00FF, #FFD700, #00FF88);
    background-size: 300% 300%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: gradShift 4s ease infinite;
    position: relative; z-index: 1;
    text-shadow: none;
    filter: drop-shadow(0 0 20px rgba(0,255,255,0.5));
  }
  @keyframes gradShift {
    0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%}
  }

  .site-subtitle {
    font-family: 'Orbitron', monospace;
    font-size: clamp(0.7rem, 2vw, 1rem);
    letter-spacing: 8px;
    color: rgba(0,255,255,0.7);
    text-transform: uppercase;
    margin-top: 8px;
    animation: blink 2s ease-in-out infinite;
  }
  @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.5} }

  .divider {
    width: 80%; max-width: 600px;
    height: 2px;
    background: linear-gradient(90deg, transparent, #00FFFF, #FF00FF, transparent);
    margin: 20px auto;
    position: relative;
  }
  .divider::after {
    content: '‚óÜ';
    position: absolute; top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    color: #FFD700; font-size: 1rem;
    text-shadow: var(--glow-gold);
    animation: rotateDiamond 4s linear infinite;
  }
  @keyframes rotateDiamond { from{transform:translate(-50%,-50%) rotate(0)} to{transform:translate(-50%,-50%) rotate(360deg)} }

  /* ===== STATS BAR ===== */
  .stats-bar {
    display: flex; justify-content: center; gap: 40px; flex-wrap: wrap;
    padding: 0 20px 30px;
    position: relative; z-index: 10;
  }
  .stat-item {
    background: rgba(0,255,255,0.05);
    border: 1px solid rgba(0,255,255,0.2);
    border-radius: 12px;
    padding: 14px 28px;
    text-align: center;
    backdrop-filter: blur(10px);
    transition: all 0.3s;
  }
  .stat-item:hover {
    border-color: #00FFFF;
    box-shadow: var(--glow-cyan);
    transform: translateY(-3px);
  }
  .stat-label {
    font-size: 0.7rem; letter-spacing: 3px;
    color: rgba(0,255,255,0.6); text-transform: uppercase;
  }
  .stat-value {
    font-family: 'Orbitron', monospace;
    font-size: 1.6rem; font-weight: 900;
    color: #00FFFF;
    text-shadow: var(--glow-cyan);
  }

  /* ===== LEADERBOARD ===== */
  .leaderboard-container {
    position: relative; z-index: 10;
    max-width: 900px; margin: 0 auto;
    padding: 0 20px 80px;
  }

  .section-title {
    font-family: 'Orbitron', monospace;
    font-size: 1.2rem; letter-spacing: 5px;
    color: rgba(255,255,255,0.5);
    text-transform: uppercase;
    text-align: center;
    margin-bottom: 30px;
  }

  /* TOP 3 PODIUM */
  .podium {
    display: flex; justify-content: center; align-items: flex-end;
    gap: 16px; margin-bottom: 40px;
    flex-wrap: wrap;
  }
  .podium-card {
    background: rgba(10,10,40,0.9);
    border-radius: 16px;
    padding: 24px 20px;
    text-align: center;
    position: relative;
    overflow: hidden;
    transition: transform 0.3s;
    backdrop-filter: blur(20px);
    cursor: default;
  }
  .podium-card:hover { transform: translateY(-8px) scale(1.02); }

  .podium-card::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0; height: 3px;
  }
  .podium-1 { order:2; width: 260px; border: 2px solid var(--gold); box-shadow: 0 0 30px rgba(255,215,0,0.3); }
  .podium-1::before { background: linear-gradient(90deg, transparent, var(--gold), transparent); }
  .podium-2 { order:1; width: 220px; border: 2px solid var(--silver); box-shadow: 0 0 20px rgba(192,192,192,0.2); }
  .podium-2::before { background: linear-gradient(90deg, transparent, var(--silver), transparent); }
  .podium-3 { order:3; width: 220px; border: 2px solid var(--bronze); box-shadow: 0 0 20px rgba(205,127,50,0.2); }
  .podium-3::before { background: linear-gradient(90deg, transparent, var(--bronze), transparent); }

  .podium-rank {
    font-family: 'Orbitron', monospace;
    font-size: 2.5rem; font-weight: 900;
    margin-bottom: 8px;
  }
  .podium-1 .podium-rank { color: var(--gold); text-shadow: var(--glow-gold); }
  .podium-2 .podium-rank { color: var(--silver); text-shadow: 0 0 10px #C0C0C0, 0 0 20px #C0C0C044; }
  .podium-3 .podium-rank { color: var(--bronze); text-shadow: 0 0 10px #CD7F32, 0 0 20px #CD7F3244; }

  .podium-crown {
    font-size: 2rem; margin-bottom: 6px;
    animation: bounce 2s ease-in-out infinite;
  }
  @keyframes bounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-6px)} }

  .podium-nick {
    font-family: 'Orbitron', monospace;
    font-size: clamp(0.8rem, 2vw, 1rem);
    font-weight: 700; letter-spacing: 2px;
    color: white; margin-bottom: 14px;
    word-break: break-all;
  }

  .podium-stats {
    display: flex; justify-content: center; gap: 12px; flex-wrap: wrap;
  }
  .pstat {
    display: flex; align-items: center; gap: 5px;
    background: rgba(255,255,255,0.07);
    border-radius: 8px; padding: 5px 10px;
    font-size: 0.9rem; font-weight: 700;
  }
  .pstat .icon { font-size: 1.1rem; }
  .pstat .val { font-family: 'Orbitron', monospace; }

  /* SHIMMER ANIMATION on #1 */
  .podium-1::after {
    content: '';
    position: absolute; top: -50%; left: -60%;
    width: 40%; height: 200%;
    background: linear-gradient(90deg, transparent, rgba(255,215,0,0.1), transparent);
    transform: skewX(-15deg);
    animation: shimmer 3s ease-in-out infinite;
  }
  @keyframes shimmer { 0%{left:-60%} 100%{left:120%} }

  /* ===== REST OF LIST ===== */
  .list-header {
    display: grid;
    grid-template-columns: 60px 1fr 130px 170px;
    padding: 10px 20px;
    font-size: 0.7rem; letter-spacing: 3px;
    color: rgba(0,255,255,0.5); text-transform: uppercase;
    border-bottom: 1px solid rgba(0,255,255,0.1);
    margin-bottom: 8px;
  }

  .player-row {
    display: grid;
    grid-template-columns: 60px 1fr 130px 170px;
    align-items: center;
    padding: 14px 20px;
    margin-bottom: 6px;
    background: rgba(10,10,40,0.7);
    border: 1px solid rgba(255,255,255,0.06);
    border-radius: 12px;
    transition: all 0.25s;
    backdrop-filter: blur(10px);
    cursor: default;
    animation: rowIn 0.4s ease both;
    position: relative; overflow: hidden;
  }
  .player-row::before {
    content: '';
    position: absolute; left: 0; top: 0; bottom: 0; width: 3px;
    background: linear-gradient(180deg, #00FFFF, #FF00FF);
    opacity: 0; transition: opacity 0.3s;
  }
  .player-row:hover {
    border-color: rgba(0,255,255,0.3);
    background: rgba(0,255,255,0.06);
    box-shadow: 0 4px 20px rgba(0,255,255,0.1);
    transform: translateX(6px);
  }
  .player-row:hover::before { opacity: 1; }

  @keyframes rowIn {
    from { opacity:0; transform:translateX(-20px); }
    to   { opacity:1; transform:translateX(0); }
  }

  .rank-num {
    font-family: 'Orbitron', monospace;
    font-size: 1rem; font-weight: 700;
    color: rgba(255,255,255,0.4);
    text-align: center;
  }
  .rank-num.top5 { color: #00FFFF; text-shadow: var(--glow-cyan); }
  .rank-num.top10 { color: #AA88FF; }

  .player-nick {
    font-family: 'Orbitron', monospace;
    font-size: clamp(0.7rem, 1.5vw, 0.95rem);
    font-weight: 700; letter-spacing: 1px;
    color: white;
    padding-left: 10px;
    word-break: break-all;
  }

  .trophies {
    display: flex; align-items: center; gap: 6px;
    font-family: 'Orbitron', monospace;
    font-size: 0.95rem; font-weight: 700;
    color: var(--gold);
    text-shadow: var(--glow-gold);
  }
  .trophy-icon { font-size: 1.3rem; }

  .medals-col {
    display: flex; align-items: center; gap: 10px; flex-wrap: wrap;
  }
  .medal {
    display: flex; align-items: center; gap: 3px;
    font-size: 0.8rem; font-weight: 700;
    font-family: 'Orbitron', monospace;
    padding: 3px 8px;
    border-radius: 6px;
    background: rgba(255,255,255,0.06);
    white-space: nowrap;
  }
  .medal-icon { font-size: 1rem; }
  .medal.gold-m   { color: var(--gold); border: 1px solid rgba(255,215,0,0.3); }
  .medal.silver-m { color: var(--silver); border: 1px solid rgba(192,192,192,0.3); }
  .medal.bronze-m { color: var(--bronze); border: 1px solid rgba(205,127,50,0.3); }

  /* ===== EDIT PANEL ===== */
  .edit-btn {
    position: fixed; bottom: 30px; right: 30px; z-index: 999;
    background: linear-gradient(135deg, #00FFFF, #FF00FF);
    color: #000; font-family: 'Orbitron', monospace;
    font-weight: 900; font-size: 0.75rem; letter-spacing: 2px;
    padding: 14px 24px; border: none; border-radius: 50px;
    cursor: pointer; text-transform: uppercase;
    box-shadow: 0 0 20px rgba(0,255,255,0.5);
    transition: all 0.3s;
  }
  .edit-btn:hover { transform: scale(1.05); box-shadow: 0 0 40px rgba(0,255,255,0.8); }

  .modal-overlay {
    display: none; position: fixed; inset: 0; z-index: 9999;
    background: rgba(0,0,0,0.85); backdrop-filter: blur(10px);
    justify-content: center; align-items: center; padding: 20px;
  }
  .modal-overlay.open { display: flex; }

  .modal {
    background: #0a0a2a;
    border: 1px solid rgba(0,255,255,0.3);
    border-radius: 20px;
    padding: 30px;
    width: 100%; max-width: 700px;
    max-height: 90vh; overflow-y: auto;
    box-shadow: 0 0 60px rgba(0,255,255,0.2);
  }
  .modal h2 {
    font-family: 'Orbitron', monospace;
    font-size: 1.2rem; letter-spacing: 3px;
    color: #00FFFF; margin-bottom: 20px;
    text-align: center; text-transform: uppercase;
  }

  .password-screen { text-align: center; }
  .password-screen input {
    background: rgba(0,255,255,0.05);
    border: 1px solid rgba(0,255,255,0.3);
    border-radius: 10px; padding: 12px 20px;
    color: white; font-family: 'Orbitron', monospace;
    font-size: 1rem; width: 100%; max-width: 300px;
    text-align: center; letter-spacing: 4px;
    outline: none; margin: 10px 0;
  }
  .password-screen input:focus { border-color: #00FFFF; box-shadow: var(--glow-cyan); }
  .modal-btn {
    background: linear-gradient(135deg, #00FFFF22, #FF00FF22);
    border: 1px solid rgba(0,255,255,0.4);
    color: white; font-family: 'Orbitron', monospace;
    font-size: 0.75rem; letter-spacing: 2px; padding: 10px 24px;
    border-radius: 8px; cursor: pointer; text-transform: uppercase;
    transition: all 0.3s; margin: 5px;
  }
  .modal-btn:hover { background: rgba(0,255,255,0.15); box-shadow: var(--glow-cyan); }
  .modal-btn.danger { border-color: rgba(255,0,100,0.4); color: #FF4488; }
  .modal-btn.danger:hover { background: rgba(255,0,100,0.1); box-shadow: 0 0 10px rgba(255,0,100,0.4); }

  .edit-table { width: 100%; border-collapse: collapse; }
  .edit-table th {
    font-family: 'Orbitron', monospace; font-size: 0.65rem;
    letter-spacing: 2px; color: rgba(0,255,255,0.7);
    padding: 6px 8px; text-align: left; border-bottom: 1px solid rgba(0,255,255,0.1);
  }
  .edit-table td { padding: 5px 4px; }
  .edit-table input {
    width: 100%;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 6px; padding: 6px 8px;
    color: white; font-family: 'Rajdhani', sans-serif;
    font-size: 0.9rem; outline: none;
    transition: border-color 0.2s;
  }
  .edit-table input:focus { border-color: #00FFFF; }
  .row-del {
    background: none; border: none; color: #FF4488;
    font-size: 1.2rem; cursor: pointer; padding: 4px 8px;
    border-radius: 4px; transition: background 0.2s;
  }
  .row-del:hover { background: rgba(255,0,100,0.1); }

  .err-msg { color: #FF4488; font-size: 0.8rem; margin-top: 8px; }
  .success-msg { color: #00FF88; font-size: 0.8rem; margin-top: 8px; }

  .last-updated {
    text-align: center;
    font-size: 0.7rem; letter-spacing: 2px;
    color: rgba(255,255,255,0.25);
    margin-top: 20px; position: relative; z-index: 10;
  }

  /* Scrollbar */
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: #050510; }
  ::-webkit-scrollbar-thumb { background: linear-gradient(#00FFFF, #FF00FF); border-radius: 3px; }

  @media(max-width: 640px) {
    .list-header { grid-template-columns: 44px 1fr 90px; }
    .list-header .col-medals { display: none; }
    .player-row { grid-template-columns: 44px 1fr 90px; }
    .medals-col { display: none; }
    .podium { gap: 10px; }
    .podium-1 { width: 200px; } .podium-2,.podium-3 { width: 160px; }
  }
</style>
</head>
<body>

<div class="grid-lines"></div>
<div class="particles" id="particles"></div>

<header>
  <div class="logo-wrapper">
    <div class="logo-glow"></div>
    <div class="site-title">STUMBLE PRIV</div>
  </div>
  <div class="site-subtitle">‚ö° Hall of Fame ¬∑ Top 30 Players ‚ö°</div>
  <div class="divider"></div>
</header>

<div class="stats-bar">
  <div class="stat-item">
    <div class="stat-label">Players Ranked</div>
    <div class="stat-value" id="total-players">30</div>
  </div>
  <div class="stat-item">
    <div class="stat-label">Total Trophies</div>
    <div class="stat-value" id="total-trophies">0</div>
  </div>
  <div class="stat-item">
    <div class="stat-label">üèÜ Leader</div>
    <div class="stat-value" id="leader-name" style="font-size:1rem;">‚Äî</div>
  </div>
</div>

<div class="leaderboard-container">
  <div class="section-title">‚ú¶ Podium ‚ú¶</div>
  <div class="podium" id="podium"></div>

  <div class="section-title" style="margin-top:40px;">‚ú¶ Rankings ‚ú¶</div>
  <div class="list-header">
    <span style="text-align:center">#</span>
    <span style="padding-left:10px">Player</span>
    <span>Trophies</span>
    <span class="col-medals">Medals</span>
  </div>
  <div id="player-list"></div>

  <div class="last-updated" id="last-updated"></div>
</div>

<!-- Edit Button -->
<button class="edit-btn" onclick="openModal()">‚öô EDIT</button>

<!-- Modal -->
<div class="modal-overlay" id="modal-overlay">
  <div class="modal">
    <div id="password-screen" class="password-screen">
      <h2>üîê Admin Access</h2>
      <input type="password" id="pwd-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="30"
        onkeydown="if(event.key==='Enter')checkPwd()">
      <br>
      <button class="modal-btn" onclick="checkPwd()">ENTER</button>
      <button class="modal-btn danger" onclick="closeModal()">CANCEL</button>
      <div id="pwd-error" class="err-msg"></div>
    </div>
    <div id="edit-screen" style="display:none">
      <h2>‚ö° Edit Rankings</h2>
      <div style="overflow-x:auto">
        <table class="edit-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Nick</th>
              <th>üèÜ Trof√©us</th>
              <th>ü•á Top1</th>
              <th>ü•à Top2</th>
              <th>ü•â Top3</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="edit-tbody"></tbody>
        </table>
      </div>
      <div style="margin-top:14px; display:flex; gap:8px; flex-wrap:wrap">
        <button class="modal-btn" onclick="addRow()">+ ADD PLAYER</button>
        <button class="modal-btn" onclick="saveData()" style="border-color:rgba(0,255,136,0.4);color:#00FF88">üíæ SAVE</button>
        <button class="modal-btn danger" onclick="closeModal()">‚úï CLOSE</button>
      </div>
      <div id="save-msg"></div>
    </div>
  </div>
</div>

<script>
// ============================================================
// DATA ‚Äî edit directly here OR use the admin panel
// ============================================================
const ADMIN_PASSWORD = "stumble2024"; // Troque a senha aqui

let players = [
  { nick:"ShadowStrike",  trophies:1310, gold:28, silver:14, bronze:9  },
  { nick:"VortexKing",    trophies:1180, gold:22, silver:18, bronze:11 },
  { nick:"NovaBlast",     trophies:1050, gold:19, silver:12, bronze:7  },
  { nick:"ZeroGravity",   trophies: 980, gold:16, silver:10, bronze:8  },
  { nick:"IronPhoenix",   trophies: 890, gold:14, silver:9,  bronze:5  },
  { nick:"ThunderX",      trophies: 820, gold:12, silver:11, bronze:6  },
  { nick:"CryptoWolf",    trophies: 760, gold:11, silver:8,  bronze:4  },
  { nick:"NeonFury",      trophies: 710, gold:10, silver:7,  bronze:5  },
  { nick:"GhostReaper",   trophies: 670, gold: 9, silver:6,  bronze:3  },
  { nick:"StormBlade",    trophies: 630, gold: 8, silver:5,  bronze:4  },
  { nick:"PyroStorm",     trophies: 590, gold: 7, silver:6,  bronze:2  },
  { nick:"DarkMatter",    trophies: 550, gold: 6, silver:4,  bronze:5  },
  { nick:"PixelPunch",    trophies: 510, gold: 5, silver:7,  bronze:3  },
  { nick:"Razorback",     trophies: 480, gold: 5, silver:3,  bronze:4  },
  { nick:"VoidWalker",    trophies: 450, gold: 4, silver:5,  bronze:2  },
  { nick:"BlazeRunner",   trophies: 420, gold: 4, silver:4,  bronze:3  },
  { nick:"QuantumLeap",   trophies: 390, gold: 3, silver:5,  bronze:4  },
  { nick:"SteelNova",     trophies: 360, gold: 3, silver:3,  bronze:3  },
  { nick:"ArcaneKnight",  trophies: 330, gold: 3, silver:2,  bronze:5  },
  { nick:"FrostBite",     trophies: 300, gold: 2, silver:4,  bronze:3  },
  { nick:"TitanFall",     trophies: 270, gold: 2, silver:3,  bronze:4  },
  { nick:"OmegaForce",    trophies: 245, gold: 2, silver:2,  bronze:2  },
  { nick:"NightCrawler",  trophies: 220, gold: 2, silver:2,  bronze:1  },
  { nick:"WarpZone",      trophies: 195, gold: 1, silver:3,  bronze:2  },
  { nick:"EchoStrike",    trophies: 175, gold: 1, silver:2,  bronze:3  },
  { nick:"HexHunter",     trophies: 155, gold: 1, silver:2,  bronze:2  },
  { nick:"PlasmaBolt",    trophies: 135, gold: 1, silver:1,  bronze:3  },
  { nick:"ChaosEngine",   trophies: 115, gold: 0, silver:2,  bronze:4  },
  { nick:"DigitalWraith", trophies:  95, gold: 0, silver:1,  bronze:3  },
  { nick:"StarKiller",    trophies:  75, gold: 0, silver:1,  bronze:2  },
];

// Load from localStorage if exists
function loadData() {
  const saved = localStorage.getItem('stumble_priv_players');
  if (saved) { try { players = JSON.parse(saved); } catch(e){} }
  const ts = localStorage.getItem('stumble_priv_ts');
  if (ts) document.getElementById('last-updated').textContent = 'Last updated: ' + ts;
}

function saveToStorage() {
  localStorage.setItem('stumble_priv_players', JSON.stringify(players));
  const now = new Date().toLocaleString('pt-BR');
  localStorage.setItem('stumble_priv_ts', now);
  document.getElementById('last-updated').textContent = 'Last updated: ' + now;
}

// ============================================================
// RENDER
// ============================================================
const CROWN_ICONS = ['üëë','ü•à','ü•â'];

function renderAll() {
  const sorted = [...players].sort((a,b) => b.trophies - a.trophies).slice(0,30);
  renderPodium(sorted);
  renderList(sorted);
  renderStats(sorted);
}

function renderPodium(sorted) {
  const podiumEl = document.getElementById('podium');
  podiumEl.innerHTML = '';
  const top3 = sorted.slice(0,3);
  const rankClass = ['podium-1','podium-2','podium-3'];
  const crowns = ['üëë','ü•à','ü•â'];
  const rankLabel = ['#1','#2','#3'];
  top3.forEach((p, i) => {
    const div = document.createElement('div');
    div.className = 'podium-card ' + rankClass[i];
    div.innerHTML = `
      <div class="podium-crown">${crowns[i]}</div>
      <div class="podium-rank">${rankLabel[i]}</div>
      <div class="podium-nick">${escHtml(p.nick)}</div>
      <div class="podium-stats">
        <div class="pstat"><span class="icon">üèÜ</span><span class="val">${p.trophies}</span></div>
        ${p.gold   > 0 ? `<div class="pstat"><span class="icon">ü•á</span><span class="val">${p.gold}</span></div>` : ''}
        ${p.silver > 0 ? `<div class="pstat"><span class="icon">ü•à</span><span class="val">${p.silver}</span></div>` : ''}
        ${p.bronze > 0 ? `<div class="pstat"><span class="icon">ü•â</span><span class="val">${p.bronze}</span></div>` : ''}
      </div>`;
    podiumEl.appendChild(div);
  });
}

function renderList(sorted) {
  const listEl = document.getElementById('player-list');
  listEl.innerHTML = '';
  sorted.slice(3).forEach((p, idx) => {
    const rank = idx + 4;
    const row = document.createElement('div');
    row.className = 'player-row';
    row.style.animationDelay = (idx * 0.04) + 's';
    const rankClass = rank <= 5 ? 'top5' : rank <= 10 ? 'top10' : '';
    const medals = [
      p.gold   > 0 ? `<span class="medal gold-m"><span class="medal-icon">ü•á</span>${p.gold}</span>`   : '',
      p.silver > 0 ? `<span class="medal silver-m"><span class="medal-icon">ü•à</span>${p.silver}</span>` : '',
      p.bronze > 0 ? `<span class="medal bronze-m"><span class="medal-icon">ü•â</span>${p.bronze}</span>` : '',
    ].join('');
    row.innerHTML = `
      <div class="rank-num ${rankClass}">${rank}</div>
      <div class="player-nick">${escHtml(p.nick)}</div>
      <div class="trophies"><span class="trophy-icon">üèÜ</span>${p.trophies}</div>
      <div class="medals-col">${medals || '<span style="opacity:0.3;font-size:0.8rem">‚Äî</span>'}</div>`;
    listEl.appendChild(row);
  });
}

function renderStats(sorted) {
  document.getElementById('total-players').textContent = sorted.length;
  const total = sorted.reduce((s,p) => s + p.trophies, 0);
  document.getElementById('total-trophies').textContent = total.toLocaleString();
  document.getElementById('leader-name').textContent = sorted[0] ? sorted[0].nick : '‚Äî';
}

function escHtml(s) {
  return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

// ============================================================
// PARTICLES
// ============================================================
function spawnParticles() {
  const container = document.getElementById('particles');
  const colors = ['#00FFFF','#FF00FF','#FFD700','#00FF88','#AA88FF'];
  for (let i = 0; i < 40; i++) {
    const p = document.createElement('div');
    p.className = 'particle';
    const size = Math.random() * 4 + 2;
    const color = colors[Math.floor(Math.random() * colors.length)];
    p.style.cssText = `
      width:${size}px; height:${size}px;
      left:${Math.random()*100}%;
      background:${color};
      box-shadow: 0 0 ${size*2}px ${color};
      animation-duration:${6 + Math.random()*10}s;
      animation-delay:${Math.random()*8}s;
    `;
    container.appendChild(p);
  }
}

// ============================================================
// ADMIN MODAL
// ============================================================
function openModal() {
  document.getElementById('modal-overlay').classList.add('open');
  document.getElementById('password-screen').style.display = 'block';
  document.getElementById('edit-screen').style.display = 'none';
  document.getElementById('pwd-input').value = '';
  document.getElementById('pwd-error').textContent = '';
  setTimeout(() => document.getElementById('pwd-input').focus(), 100);
}

function closeModal() {
  document.getElementById('modal-overlay').classList.remove('open');
}

function checkPwd() {
  const val = document.getElementById('pwd-input').value;
  if (val === ADMIN_PASSWORD) {
    document.getElementById('password-screen').style.display = 'none';
    document.getElementById('edit-screen').style.display = 'block';
    buildEditTable();
  } else {
    document.getElementById('pwd-error').textContent = '‚ùå Senha incorreta!';
    document.getElementById('pwd-input').value = '';
    document.getElementById('pwd-input').focus();
  }
}

function buildEditTable() {
  const sorted = [...players].sort((a,b) => b.trophies - a.trophies).slice(0,30);
  const tbody = document.getElementById('edit-tbody');
  tbody.innerHTML = '';
  sorted.forEach((p, i) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td style="color:rgba(0,255,255,0.6);font-family:'Orbitron',monospace;text-align:center;padding:5px 8px">${i+1}</td>
      <td><input type="text" value="${escHtml(p.nick)}" placeholder="Nick" data-field="nick" data-idx="${i}"></td>
      <td><input type="number" value="${p.trophies}" min="0" data-field="trophies" data-idx="${i}"></td>
      <td><input type="number" value="${p.gold}" min="0" data-field="gold" data-idx="${i}"></td>
      <td><input type="number" value="${p.silver}" min="0" data-field="silver" data-idx="${i}"></td>
      <td><input type="number" value="${p.bronze}" min="0" data-field="bronze" data-idx="${i}"></td>
      <td><button class="row-del" onclick="deleteRow(${i})" title="Remover">‚úï</button></td>`;
    tbody.appendChild(tr);
  });
  // store sorted reference
  window._editSorted = sorted;
}

function deleteRow(idx) {
  if (!confirm('Remover este jogador?')) return;
  const sorted = window._editSorted;
  const nick = sorted[idx].nick;
  players = players.filter(p => p.nick !== nick);
  buildEditTable();
}

function addRow() {
  players.push({ nick:'NewPlayer', trophies:0, gold:0, silver:0, bronze:0 });
  buildEditTable();
  // scroll to bottom of table
  const tbody = document.getElementById('edit-tbody');
  tbody.lastElementChild?.scrollIntoView({behavior:'smooth'});
}

function saveData() {
  const inputs = document.querySelectorAll('#edit-tbody input');
  const sorted = window._editSorted;
  // update sorted array from inputs
  inputs.forEach(input => {
    const idx = parseInt(input.dataset.idx);
    const field = input.dataset.field;
    if (field === 'nick') sorted[idx].nick = input.value.trim() || 'Unknown';
    else sorted[idx][field] = Math.max(0, parseInt(input.value) || 0);
  });
  // rebuild players from sorted (remove old entries, replace with new)
  players = sorted;
  saveToStorage();
  renderAll();
  const msg = document.getElementById('save-msg');
  msg.className = 'success-msg';
  msg.textContent = '‚úÖ Salvo com sucesso!';
  setTimeout(() => msg.textContent = '', 3000);
  buildEditTable();
}

// Close modal clicking outside
document.getElementById('modal-overlay').addEventListener('click', function(e) {
  if (e.target === this) closeModal();
});

// ============================================================
// INIT
// ============================================================
loadData();
renderAll();
spawnParticles();
</script>
</body>
</html>
